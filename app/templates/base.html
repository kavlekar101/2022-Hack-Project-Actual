<head>
    {% if title %}
        <title>{{ title }}</title>
    {% else %}
        <title>No title assigned</title>
    {% endif %}
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="{{ url_for('static', filename='css/base.css') }}" rel="stylesheet">
    {% block head %}{% endblock %}
</head>

<body>
	<header>
	  <nav>
		<a href="#home" class="active">Home</a>
		<a href="#about">About</a>
		<a href="#script">Find Rooms</a>
	  </nav>
	</header>
	<section id="home">
	  <div class="container reveal">
		<h1>Welcome To Room Matrix &#8595;</h1>
		<div class="container">
			<div class="scene">
				<div class="webpack-cube">
					<div class="outer-cube">
						<div class="face face-top"></div>
						<div class="face face-bottom"></div>
						<div class="face face-left"></div>
						<div class="face face-right"></div>
						<div class="face face-front"></div>
						<div class="face face-back"></div>
					</div>
					<div class="inner-cube">
						<div class="face face-top"></div>
						<div class="face face-bottom"></div>
						<div class="face face-left"></div>
						<div class="face face-right"></div>
						<div class="face face-front"></div>
						<div class="face face-back"></div>
					</div>
				</div>
				<div class="shadows-outer-container">
					<div class="shadow-outer"></div>
					</div>
				<div class="shadows-inner-container">
					<div class="shadow-inner"></div>
				</div>
			</div>
		</div>
	  </div>
	</section>
	<section id="about">
	  <div class="container reveal">
		<h2>About</h2>
		<div class="text-container">
		  <div class="text-box">
			<h3>What is Room Matrix?</h3>
			<p>
				Room Matrix is an application made for college students trying to find available rooms or lecture halls to study in!</p>
				
			<br>
			<br>
			<p>	
				Simply enter buildings, days, and times to figure out all rooms that are open. It's time to stop wasting time searching for places to study!
					
			</p>
			<br>
			<br>
			<p>
				Try it out down below!
			</p>
			<br>
		  </div>
		</div>
	  </div>
	</section>
    
    <section id="script">
        <div class="container reveal">
            <form action="" method='POST' name="myform">
                {{ form.csrt_token }}
                <div id="box" class="login-box">
					<form>
					  <div class="user-box">
							<select name="building" method="GET" action="/" value="{{ request.form['building'] }}">
								<option value="" selected disabled hidden>Building</option>
								<option value="{{buildings[0]}}" style="color:white;">{{buildings[0]}}</option>
								{% for building in buildings[1:] %}
								<option value="{{building}}" style="color:white;">{{building}}</option>
								{% endfor %}
							</select>
					  </div>
					  <div class="user-box date"> 
						{{ form.startdate.label }} {{form.startdate(class='datepicker')}} {{form.hidden_tag()}} 
					  </div>
					  <div class="user-box">
							<label>Start Time</label>
							<input type="time" id="appt" name="appt1" min="00:00" max="23:59" required>
					  </div>
					  <div class="user-box">
							<label>End Time</label>
							<input type="time" id="appt" name="appt2" min="00:00" max="23:59" required>
					  </div>
					  {{form.submit()}}
					</form>
				  </div>
                
                </p>
            </form>
        </div>

		{% if results %}
		{% block content %}
		<article class="leaderboard">
			<header>
			  <h1 class="leaderboard__title"><span class="leaderboard__title--top">Available Rooms in {{buildingName}}</span><span class="leaderboard__title--bottom"></span></h1>
			</header>
			
			{% for result in results %}
			  <article class="leaderboard__profile">
				<span class="leaderboard__name">{{result}}</span>
			  </article>
			{% endfor %}
		</article>
			 
	
		{% endblock content %}
		{% endif %}
    </section>

	<script>

		let section = document.querySelectorAll("section");
		let menu = document.querySelectorAll("header nav a");

		// sets section window attributes
		window.onscroll = () => {
			section.forEach((i) => {
				let top = window.scrollY;
				let offset = i.offsetTop - 150;
				let height = i.offsetHeight;
				let id = i.getAttribute("id");

				// handles changing nav button from "active" status to non-active if not on that section of page
				if (top >= offset && top < offset + height) {
					menu.forEach((link) => {
						link.classList.remove("active");
						document
						.querySelector("header nav a[href*=" + id + "]")
						.classList.add("active");
					});
				}
			});
		};

		function reveal() {
			// everything in the section that is supposed to be hidden then gets revealed when scrolled to
			var reveals = document.querySelectorAll(".reveal");
			// for each section's revealing text, set the boudary for where the window has to reach in order for the text to be revealed
			for (var i = 0; i < reveals.length; i++) {
				var windowHeight = window.innerHeight;
				var elementTop = reveals[i].getBoundingClientRect().top;
				var elementVisible = 150;

				// when the window passes the section area, reveal it, when the window y-axis, hide it. This way when the scroll passes the section it gets revealed, and doesn't get hidden until it scrolls back up past it
				if (elementTop < windowHeight - elementVisible) {
				reveals[i].classList.add("active");
				} else {
				reveals[i].classList.remove("active");
				}
			}
		}

		// event listener for scrolling
		window.addEventListener("scroll", reveal);


		/*var myButton = document.getElementById("submit");
		var myDiv = document.getElementById("box");
		myButton.addEventListener("click", ()=>{
			myDiv.classList.add("foo");
		});*/
		// To check the scroll position on page load
		reveal();

	</script>

</body>